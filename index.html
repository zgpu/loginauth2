<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firebase Google Login</title>
    <script src="https://www.gstatic.com/firebasejs/9.9.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.9.1/firebase-auth.js"></script>
</head>
<body>
    <script>
        // Your Firebase configuration

	    alert("n");

	    
       const firebaseConfig = {
		  apiKey: "AIzaSyCr_AoZc16XaZhx29nLMWFpNDCpw7slbsI",
		  authDomain: "test-fb-6c12b.firebaseapp.com",
		  projectId: "test-fb-6c12b",
		  storageBucket: "test-fb-6c12b.appspot.com",
		  messagingSenderId: "925911738571",
		  appId: "1:925911738571:web:95bc056c8ed3e4003d534e"
		};

        // Initialize Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const auth = firebase.getAuth(app);

        // Function to get URL parameter
        function getUrlParameter(name) {
            name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
            const regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
            const results = regex.exec(location.search);
            return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
        }

        // Check token parameter
        const token = getUrlParameter('token');
        if (token == '2') {
            // Token is 2, proceed with action
            console.log('Token is 2, proceeding...');
        } else {
            // Token is not 2, initiate Google login
            console.log('Token is not 2, initiating Google login...');
            const provider = new firebase.GoogleAuthProvider();

            firebase.signInWithPopup(auth, provider)
                .then((result) => {
                    const user = result.user;
                    const gmailId = user.email;
                    const name = user.displayName;

                    // Send back the string to the sender page
                    const returnString = `2+${gmailId}+${name}`;
                    window.opener.postMessage(returnString, "*");
                    window.close();
                })
                .catch((error) => {
                    console.error('Error during authentication:', error);
                });
        }
    </script>
</body>
</html>
